diff -ruN 777-300.orig/777-300ER-set.xml 777-300/777-300ER-set.xml
--- 777-300.orig/777-300ER-set.xml	2012-02-16 21:15:28.000000000 +0800
+++ 777-300/777-300ER-set.xml	2015-03-14 21:43:47.073649020 +0800
@@ -7,7 +7,7 @@
         <aircraft-version>20111211</aircraft-version>
         <flight-model>yasim</flight-model>
         <aero>777-300ER</aero>
-        <fuel-fraction>0.75</fuel-fraction>
+        <fuel-fraction>0.10</fuel-fraction>
         <startup>
             <splash-texture>Aircraft/777-300/splash_ER.png</splash-texture>
         </startup>
@@ -155,6 +155,76 @@
             <z-offset-m type="double">-21.5</z-offset-m>
 		</config>
 	</view>		
+
+	<view n="104">
+	    <name>Visitor 1 view</name>
+		<type>lookfrom</type>
+		<internal type="bool">true</internal>
+		<config>
+            <default-field-of-view-deg type="double">70.0</default-field-of-view-deg>		
+			<from-model type="bool">true</from-model>
+			<from-model-idx type="int">0</from-model-idx>
+            <x-offset-m type="double">0.015</x-offset-m>
+            <y-offset-m type="double">0.8</y-offset-m>
+            <z-offset-m type="double">-27.15</z-offset-m>
+		</config>
+	</view>	
+	
+	<view n="105">
+	    <name>Visitor 2 view</name>
+		<type>lookfrom</type>
+		<internal type="bool">true</internal>
+		<config>
+            <default-field-of-view-deg type="double">70.0</default-field-of-view-deg>		
+			<from-model type="bool">true</from-model>
+			<from-model-idx type="int">0</from-model-idx>
+            <x-offset-m type="double">0.85</x-offset-m>
+            <y-offset-m type="double">0.8</y-offset-m>
+            <z-offset-m type="double">-27.15</z-offset-m>
+		</config>
+	</view>		
+	
+	<view n="106">
+	    <name>Passenger 1</name>
+		<type>lookfrom</type>
+		<internal type="bool">true</internal>
+		<config>
+            <default-field-of-view-deg type="double">70.0</default-field-of-view-deg>		
+			<from-model type="bool">true</from-model>
+			<from-model-idx type="int">0</from-model-idx>
+            <x-offset-m type="double">2.52</x-offset-m>
+            <y-offset-m type="double">0.35</y-offset-m>
+            <z-offset-m type="double">-8.38</z-offset-m>
+		</config>
+	</view>		
+
+	<view n="107">
+	    <name>Passenger 2</name>
+		<type>lookfrom</type>
+		<internal type="bool">true</internal>
+		<config>
+            <default-field-of-view-deg type="double">70.0</default-field-of-view-deg>		
+			<from-model type="bool">true</from-model>
+			<from-model-idx type="int">0</from-model-idx>
+            <x-offset-m type="double">-2.58</x-offset-m>
+            <y-offset-m type="double">0.33</y-offset-m>
+            <z-offset-m type="double">19.03</z-offset-m>
+		</config>
+	</view>		
+	
+	<view n="108">
+	    <name>Passenger 3</name>
+		<type>lookfrom</type>
+		<internal type="bool">true</internal>
+		<config>
+            <default-field-of-view-deg type="double">70.0</default-field-of-view-deg>		
+			<from-model type="bool">true</from-model>
+			<from-model-idx type="int">0</from-model-idx>
+            <x-offset-m type="double">2.52</x-offset-m>
+            <y-offset-m type="double">0.35</y-offset-m>
+            <z-offset-m type="double">-0.6</z-offset-m>
+		</config>
+	</view>		
 	
     <airport>
         <runways>
@@ -338,6 +408,17 @@
        					</script>
       					</binding>
      				</item>										
+					<item>
+      					<label>Ground services</label>
+      					<binding>
+       					<command>nasal</command>
+       					<script>
+						var mal = gui.Dialog.new("/sim/gui/dialogs/services/menu/dialog", 
+                                                              "Aircraft/777-300/Systems/services.xml");
+        				mal.open();
+       					</script>
+      					</binding>
+     				</item>						
                     <item>
                         <label>Select Livery</label>
                         <binding>
@@ -365,7 +446,7 @@
 
         <weight n="0">
             <name>Crew</name>
-            <weight-lb>350</weight-lb>
+            <weight-lb>500</weight-lb>
             <max-lb>500</max-lb>
             <min-lb>350</min-lb>
         </weight>
@@ -373,7 +454,7 @@
         <weight n="1">
         <!--  328 pax max @ 180 lbs -->
             <name>Pax</name>
-            <weight-lb>50000</weight-lb>
+            <weight-lb>59000</weight-lb>
             <max-lb>59000</max-lb>
             <min-lb>0</min-lb>
         </weight>
@@ -493,8 +574,8 @@
                     <property>instrumentation/afds/inputs/hdg-hold</property>
                 </binding>
             </key>
-            <key n="9">
-                <name>Ctrl-I</name>
+            <key n="2">
+                <name>Ctrl-B</name>
                 <desc>toggle auto spoilers</desc>
                 <binding>
                     <command>nasal</command>
@@ -617,14 +698,14 @@
    </binding>
   </mod-up>
  </key> 
-  <key n="2">
+  <!--key n="2">
   <name>Ctrl-B</name>
   <desc>FUBAR 3</desc>
   <binding>
    <command>property-toggle</command>
    <property>/foo/bar</property>
   </binding>
- </key>
+ </key-->
  
   <key n="71">
   <name>G</name>
@@ -868,7 +949,7 @@
             <maingear-steering-cmd-norm type="double">0</maingear-steering-cmd-norm>
         </gear>
         <flight>
-            <speedbrake-lever type="int">1</speedbrake-lever>
+            <speedbrake-lever type="int">0</speedbrake-lever>
         </flight>
     </controls>
 
@@ -900,6 +981,8 @@
 			<file>Aircraft/777-300/Nasal/failures.nas</file>
             <file>Aircraft/777-300/Nasal/ground_steering.nas</file>
             <file>Aircraft/Generic/limits.nas</file>
+			<file>Aircraft/777-300/Nasal/doors.nas</file>
+			<file>Aircraft/777-300/Nasal/auto_refuel.nas</file>
         </b777>
         <dialogs>
             <file>Aircraft/777-300/Nasal/dialogs.nas</file>
@@ -938,6 +1021,7 @@
         <vne>600</vne>
         <max-positive-g>2.5</max-positive-g> 
         <max-negative-g>-1.76</max-negative-g>
+		<estimated-range-nm>8500</estimated-range-nm>
     </limits>
 
 </PropertyList>
diff -ruN 777-300.orig/777-300-set.xml 777-300/777-300-set.xml
--- 777-300.orig/777-300-set.xml	2012-02-16 21:15:28.000000000 +0800
+++ 777-300/777-300-set.xml	2015-03-14 17:04:41.521377548 +0800
@@ -7,7 +7,7 @@
         <aircraft-version>20111229</aircraft-version>
         <flight-model>yasim</flight-model>
         <aero>777-300</aero>
-        <fuel-fraction>0.75</fuel-fraction>
+        <fuel-fraction>0.10</fuel-fraction>
         <startup>
             <splash-texture>Aircraft/777-300/splash.png</splash-texture>
         </startup>
@@ -188,7 +188,7 @@
 	<view n="106">
 	    <name>Passenger 1</name>
 		<type>lookfrom</type>
-		<internal type="bool">false</internal>
+		<internal type="bool">true</internal>
 		<config>
             <default-field-of-view-deg type="double">70.0</default-field-of-view-deg>		
 			<from-model type="bool">true</from-model>
@@ -202,7 +202,7 @@
 	<view n="107">
 	    <name>Passenger 2</name>
 		<type>lookfrom</type>
-		<internal type="bool">false</internal>
+		<internal type="bool">true</internal>
 		<config>
             <default-field-of-view-deg type="double">70.0</default-field-of-view-deg>		
 			<from-model type="bool">true</from-model>
@@ -216,7 +216,7 @@
 	<view n="108">
 	    <name>Passenger 3</name>
 		<type>lookfrom</type>
-		<internal type="bool">false</internal>
+		<internal type="bool">true</internal>
 		<config>
             <default-field-of-view-deg type="double">70.0</default-field-of-view-deg>		
 			<from-model type="bool">true</from-model>
@@ -561,7 +561,7 @@
 
         <weight n="0">
             <name>Crew</name>
-            <weight-lb>350</weight-lb>
+            <weight-lb>500</weight-lb>
             <max-lb>500</max-lb>
             <min-lb>350</min-lb>
         </weight>
@@ -569,7 +569,7 @@
         <weight n="1">
         <!--  328 pax max @ 180 lbs -->
             <name>Pax</name>
-            <weight-lb>50000</weight-lb>
+            <weight-lb>59000</weight-lb>
             <max-lb>59000</max-lb>
             <min-lb>0</min-lb>
         </weight>
@@ -692,8 +692,8 @@
                     <property>instrumentation/afds/inputs/hdg-hold</property>
                 </binding>
             </key>
-            <key n="9">
-                <name>Ctrl-I</name>
+            <key n="2">
+                <name>Ctrl-B</name>
                 <desc>toggle auto spoilers</desc>
                 <binding>
                     <command>nasal</command>
@@ -816,14 +816,14 @@
    </binding>
   </mod-up>
  </key> 
-  <key n="2">
+  <!--key n="2">
   <name>Ctrl-B</name>
   <desc>FUBAR 3</desc>
   <binding>
    <command>property-toggle</command>
    <property>/foo/bar</property>
   </binding>
- </key>
+ </key-->
  
   <key n="71">
   <name>G</name>
@@ -1101,6 +1101,7 @@
             <file>Aircraft/777-300/Nasal/ground_steering.nas</file>
             <file>Aircraft/Generic/limits.nas</file>
 			<file>Aircraft/777-300/Nasal/doors.nas</file>
+			<file>Aircraft/777-300/Nasal/auto_refuel.nas</file>
         </b777>
         <dialogs>
             <file>Aircraft/777-300/Nasal/dialogs.nas</file>
@@ -1148,6 +1149,7 @@
         <vne>600</vne>
         <max-positive-g>2.5</max-positive-g> 
         <max-negative-g>-1.76</max-negative-g>
+		<estimated-range-nm>6000</estimated-range-nm>
     </limits>
 
 </PropertyList>
diff -ruN 777-300.orig/Models/OHpanel.xml 777-300/Models/OHpanel.xml
--- 777-300.orig/Models/OHpanel.xml	2012-05-20 10:05:46.000000000 +0800
+++ 777-300/Models/OHpanel.xml	2015-03-08 12:31:16.314990704 +0800
@@ -2704,7 +2704,7 @@
 			}
 			}
 			if (getprop("/controls/electric/APU-button")==1)
-			settimer(aputurnon, 40);
+			settimer(aputurnon, 10);
 			controls.click(2);
 			</script>
 			</binding>		
@@ -2731,7 +2731,7 @@
 			setprop("/controls/electric/APU-generator", 0);
 			}
 			if (getprop("/controls/electric/APU-button")==-1 and getprop("/controls/electric/APU-generator")==1)
-			settimer(apushutdown, 21);
+			settimer(apushutdown, 5);
 			controls.click(2);
 			</script>
 			</binding>		
@@ -11612,4 +11612,4 @@
         </action>
     </animation>	
 	
-</PropertyList>
\ No newline at end of file
+</PropertyList>
diff -ruN 777-300.orig/Nasal/AFDS.nas 777-300/Nasal/AFDS.nas
--- 777-300.orig/Nasal/AFDS.nas	2012-02-16 21:15:44.000000000 +0800
+++ 777-300/Nasal/AFDS.nas	2015-03-08 19:36:15.663673556 +0800
@@ -78,8 +78,8 @@
         m.AP_speed_mode = m.AFDS_apmodes.initNode("speed-mode","");
         m.AP_annun = m.AFDS_apmodes.initNode("mode-annunciator"," ");
 
-        m.FMS = props.globals.initNode("instrumentation/nav/slaved-to-gps");
-        m.FMS.setValue(0);
+        #m.FMS = props.globals.initNode("instrumentation/nav/slaved-to-gps");
+        #m.FMS.setValue(0);
 
         m.APl = setlistener(m.AP, func m.setAP(),0,0);
         m.APdisl = setlistener(m.AP_disengaged, func m.setAP(),0,0);
@@ -97,7 +97,7 @@
             if(me.lateral_mode.getValue() ==btn) btn=0;
             if(btn==3)fms=1;
             me.lateral_mode.setValue(btn);
-            me.FMS.setValue(fms);
+            #me.FMS.setValue(fms);
         }elsif(mode==1){
             # vertical AP controls
             if(me.vertical_mode.getValue() ==btn) btn=0;
diff -ruN 777-300.orig/Nasal/auto_refuel.nas 777-300/Nasal/auto_refuel.nas
--- 777-300.orig/Nasal/auto_refuel.nas	1970-01-01 08:00:00.000000000 +0800
+++ 777-300/Nasal/auto_refuel.nas	2015-03-14 16:48:15.649361566 +0800
@@ -0,0 +1,21 @@
+var l_auto_refuel = setlistener('/autopilot/route-manager/active', func {
+    if (!getprop('/autopilot/route-manager/active')) {
+        return;
+    }
+
+	var range = getprop('/limits/estimated-range-nm');
+	var route_len = getprop('/autopilot/route-manager/total-distance');
+	var fuel_norm = route_len / range;
+	if (fuel_norm > 1.0) {
+		fuel_norm = 1.0;
+	} else if (fuel_norm < 0.1) {
+		fuel_norm = 0.1;
+	}
+	setprop('/consumables/fuel/tank/level-norm', fuel_norm);
+	setprop('/consumables/fuel/tank[1]/level-norm', fuel_norm);
+	setprop('/consumables/fuel/tank[2]/level-norm', fuel_norm);
+
+    removelistener(l_auto_refuel);
+	print('Aircraft refueled.');
+});
+
diff -ruN 777-300.orig/Systems/777-autopilot.xml 777-300/Systems/777-autopilot.xml
--- 777-300.orig/Systems/777-autopilot.xml	2012-02-16 21:15:46.000000000 +0800
+++ 777-300/Systems/777-autopilot.xml	2015-03-08 19:29:20.003662425 +0800
@@ -107,7 +107,7 @@
       <value>LNAV</value>
     </enable>
     <input>
-      <prop>/autopilot/internal/nav1-heading-error-deg</prop>
+      <prop>/autopilot/internal/true-heading-error-deg</prop>
     </input>
     <reference>
       <value>0</value>
@@ -261,7 +261,7 @@
         <value>-16.67</value>
       </u_min>
       <u_max>
-        <value>33.33</value>
+        <value>16.67</value>
       </u_max>
     </config>
    </pi-simple-controller>
@@ -329,10 +329,10 @@
       <Kp>0.3</Kp>
       <Ki>0.0</Ki>
       <u_min>
-        <value>-10</value>
+        <value>-16.67</value>
       </u_min>
       <u_max>
-        <value>15</value>
+        <value>16.67</value>
       </u_max>
     </config>
   </pi-simple-controller>
@@ -402,7 +402,7 @@
         <value>-16.67</value>
       </u_min>
       <u_max>
-        <value>33.33</value>
+        <value>16.67</value>
       </u_max>
     </config>
   </pi-simple-controller>
